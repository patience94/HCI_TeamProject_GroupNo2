<!DOCTYPE html>
<html>
<head>
	<title>Neutron - Bitmap Test Page</title>
    
    <style type="text/css" title="currentStyle">
		@import "media/css/demo_page.css";
		@import "media/css/demo_table.css";
		.dataTables_filter {
            display: none; 
        }
	</style>
 	<script type="text/javascript" src="media/js/jquery.js"></script>
    <script type="text/javascript" language="javascript" src="media/js/jquery.dataTables.js"></script>

     
    <script type="text/javascript">
	
	    // This is the object Neutron expects to talk to when it needs to send something out,
	    // by calling neutronJavaScriptHandler.handle(cmdID, jsonArgs)
		//
        window.neutronJavaScriptHandler = {
            // We should not let any exception throw out of this function, otherwise we will
            // get a crash on debug Neutron (with the Qt implementation).
            handle: function (commandId, jsonArgs) {
                try {
                    if (commandId == 'OpenDocument') {
                        var jsonObject = JSON.parse(jsonArgs);
                        var assetId = jsonObject.AssetID;
                        var tmpDir = jsonObject.tempDir;
                        createViews(assetId);
                    } else {
                        return jsonArgs;
                    }
                } catch (err) {
                    console.log("Exception occured executing AcIPC: " + commandId + ", args: " + jsonArgs);
                }

                return "processed";
            }
        }

        function createViews(assetId) {
            var cameraPosition = {'x':0,'y':0,'z':0};
            var cameraTarget = {'x':0,'y':-1,'z':0};
            var cameraUpVector = {'x':0,'y':0,'z':-1};
            var scale = .25;
            var imageHeight = 350;
            var imageWidth = 350;
            var path = '/tmp/';
            var filename = '';
            var optArgs = ['TransparentBackground', 'EncodedString']
            sendJavaScriptAPIcommand(cameraPosition, cameraTarget, cameraUpVector, scale, imageHeight, imageWidth, path, filename, optArgs, assetId, 'ImgTop');
            cameraTarget = {'x':1,'y':1,'z':1};
            cameraUpVector = { 'x': 0, 'y': 1, 'z': 0 };
            scale = .25;
            sendJavaScriptAPIcommand( cameraPosition, cameraTarget, cameraUpVector, scale, imageHeight, imageWidth, path, filename, optArgs, assetId, 'ImgIso');
            cameraTarget =  {'x':0,'y':0,'z':-1};
            cameraUpVector = { 'x': 0, 'y': 1, 'z': 0 };
            scale = .25;
            sendJavaScriptAPIcommand( cameraPosition, cameraTarget, cameraUpVector, scale, imageHeight, imageWidth, path, filename, optArgs, assetId, 'ImgFront');
            cameraTarget = {'x':1,'y':0,'z':0};
            cameraUpVector = { 'x': 0, 'y': 1, 'z': 0 };
            optArgs = ['TransparentBackground', 'EncodedString']
            scale = .25;
            sendJavaScriptAPIcommand(cameraPosition, cameraTarget, cameraUpVector, scale, imageHeight, imageWidth, path, filename, optArgs, assetId, 'ImgSide');
	    }

	    function sendJavaScriptAPIcommand(cameraPositionArg, cameraTargetArg, cameraUpVectorArg, scaleArg, imageHeightArg, imageWidthArg, pathArg, filenameArg, optArgsArg, assetIdArg, controlID) {
            if (window.neutronJavaScriptObject) {
              
                // Try sending "neuUI.snapshot" for the command and {"x":0,"y":0,"z":0},{"x":-1,"y":-1,"z":-1},{"x":0,"y":1,"z":0},1,1024,1024,"" ,"/tmp/", 2 for the args
                // arguments are "camera_position", "camera_target","camera_upvector","scale","image_width","image_height","image_name" -if blank you want a stream back,"save_location","asset_id","flags"
                // flags right now don't work in JavaScript API.
                // your return value should be something like data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAA....
                var rcJSON = window.neutronJavaScriptObject.neuUI.snapshot(cameraPositionArg, cameraTargetArg, cameraUpVectorArg, scaleArg, imageHeightArg, imageWidthArg, filenameArg, pathArg, assetIdArg, optArgsArg);
                
                // Update img element with image data
                $("#" + controlID).attr('src', rcJSON);

                return rcJSON;
                
            }
		}
        

	</script>
    <script src="http://ajax.aspnetcdn.com/ajax/jquery/jquery-1.9.0.js"></script>
	<script type="text/javascript">
	    $(document).ready(function () {
	        if (window.neutronJavaScriptObject) {
	            eval(window.neutronJavaScriptObject.executeQuery('initializeSDK'));
	            window.neutronJavaScriptObject.executeCommand("PageLoaded", "");

	        }
	    });
    </script>



</head>
<body id="dt_example">
		<div id="container">
        <img src="media/images/autodesk.png" /> <br /> 

     <!-- <img  id='jsImage' alt="Neutron Test Image" src="" height="350" width="350"/> -->
            
    <table >
	
		<tr>
			<td><img  id='ImgTop' alt="Top View" src="" height="350" width="350"/></td>
			<td><img  id='ImgIso' alt="Iso View" src="" height="350" width="350"/></td>
		</tr>
	   
		<tr >
			<td><img  id='ImgFront' alt="Front View" src="" height="350" width="350"/></td>
			<td><img  id='ImgSide' alt="Side View" src="" height="350" width="350"/></td>
		</tr>
	   
    </table>


</body>
</html>